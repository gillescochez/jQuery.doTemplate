/*! github.com/gillescochez/jQuery.doTemplate */
(function($){$.doTemplate=function(){var a=function(a){return this.source=a.source,this.data=a.data,this.source&&(this.compiler=$.doTemplate.engine(this.source)),this.data?this.compile(a.data):this.compiled=null,this};return $.extend(a.prototype,{compile:function(a){var b=document.createDocumentFragment(),c=document.createElement("div"),d=this.compiler||$.doTemplate.engine(this.source),e,f,g=function(a,c){e=d(c),f=$(e),f[0]?f.data("doTemplate",{source:this.source,data:c}).each(function(){b.appendChild(this)}):(b.constructor!=String&&(b=""),b+=e)};return a=a||this.data||null,a?(a.constructor!=Array&&(a=[a]),$.each(a,g),b.constructor==String?this.compiled=b:this.compiled=$(b),this):this},appendTo:function(a){return this.render(a,"append")},prependTo:function(a){return this.render(a,"prepend")},insertBefore:function(a){return this.render(a,"before")},insertAfter:function(a){return this.render(a,"after")},replace:function(a){return this.render(a,"replaceWith")},render:function(a,b){return $(a)[b](this.compiled.jquery?this.compiled.clone(!0):this.compiled),this}}),function(){var b=arguments,c;if(b.length===0)return new a;if(b.length===1){if(b[0]instanceof jQuery||b[0].nodeType)return c=$.doTemplate.__(b[0]),new a({source:c.source,data:c.data});if(b[0].constructor==String)return new a({source:b[0]});if(b[0].constructor==Object)return new a(b[0])}if(b.length===2&&b[0].constructor==String)return b[1]instanceof jQuery||b[1].nodeType?(c=$.doTemplate._(b[1]),new a({source:b[0],data:c.data})):new a({source:b[0],data:b[1]});if(b.length===3&&b[0].constructor==String&&b[1].constructor==Object)return new a({source:b[0],data:b[1],target:b[2]})}}(),$.doTemplate._=function(a){var b;a instanceof jQuery&&(a=a[0]);while(a&&a.nodeType===1&&!(b=jQuery.data(a,"doTemplate"))&&(a=a.parentNode));return b||null},$.doTemplate.engine=function(){var resolveDefs=function(c,block,def){return(typeof block=="string"?block:block.toString()).replace(c.define,function(match,code,assign,value){return code.indexOf("def.")===0&&(code=code.substring(4)),code in def||(assign===":"?def[code]=value:eval("def[code]="+value)),""}).replace(c.use,function(match,code){var v=eval(code);return v?resolveDefs(c,v,def):v})};return function(a,b,c){b=$.extend($.doTemplate.settings,b,!0);var d=b.append?"'+(":"';out+=(",e=b.append?")+'":");out+='",f=b.use||b.define?resolveDefs(b,a,c||{}):a;f=("var out='"+(b.strip?f.replace(/\s*<!\[CDATA\[\s*|\s*\]\]>\s*|[\r\n\t]|(\/\*[\s\S]*?\*\/)/g,""):f).replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(b.interpolate,function(a,b){return d+b.replace(/\\'/g,"'").replace(/\\\\/g,"\\").replace(/[\r\t\n]/g," ")+e}).replace(b.encode,function(a,b){return d+b.replace(/\\'/g,"'").replace(/\\\\/g,"\\").replace(/[\r\t\n]/g," ")+").toString().replace(/&(?!\\w+;)/g, '&#38;').split('<').join('&#60;').split('>').join('&#62;').split('"+'"'+"').join('&#34;').split("+'"'+"'"+'"'+").join('&#39;').split('/').join('&#47;'"+e}).replace(b.evaluate,function(a,b){return"';"+b.replace(/\\'/g,"'").replace(/\\\\/g,"\\").replace(/[\r\t\n]/g," ")+"out+='"})+"';return out;").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").split("out+='';").join("").split("var out='';out+=").join("var out=");try{return new Function(b.varname,f)}catch(g){throw g}}}(),$.doTemplate.settings={evaluate:/\{\{([\s\S]+?)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,varname:"it",strip:!0,append:!0},$.fn.doTemplate=function(a,b){return a instanceof jQuery||a.nodeType?(a instanceof jQuery&&(a=a[0]),$.doTemplate({source:$(this).html(),data:$.doTemplate._(a).data})):$.doTemplate({source:$(this).html(),data:a,complete:b})}})(jQuery)